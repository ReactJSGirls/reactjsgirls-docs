---
name: 4 - Get Cat
menu: Tinder For Cats
route: /tinder-for-cats/call-the-api
---

import Code from '../components/code'

# Get New Cat on Page Load

## The API

For this application we will be using a free API that gives us cat images: [https://www.catis.life](https://www.catis.life)

The only endpoint we care about is `/cat`, which will give us a random cat for each API call we make.

[https://www.catis.life/cat](https://www.catis.life/cat)

## Call this API

To make API calls, we will use the [fetch API](https://developers.google.com/web/updates/2015/03/introduction-to-fetch) to get the data we just mentioned above. So let's create a function to do that in our `index.js`:

<Code
  code={`
const App = () => {
  const getCat = () => {
    const url = 'https://catis.life/cat'
    setCurrentCat(null)
\n
    fetch(url)
      .then(rsp => rsp.json())
      .then(data => setCurrentCat(data.cat))
  }
\n
....
}
`}
/>

Here we created a function using the arrow syntax in order to make state available in our `App` and added a `getCat` function inside of it. This function will fetch the data we need for our app.

<Code
  code={`
    fetch(url)
      .then(response => response.json())
      .then(data => setCurrentCat(data.cat))
`}
/>

After we call the fetch function, we will transform the data we receive to JSON. This will make it easier for us to handle the data in our app. The next step is to change our state with `setCurrentCat`.

`setCurrentCat` changes the state of our component and in this case the component is our whole App.

But as you can see, we have no `setCurrentCat` defined.

To add this state to our file, we add this before the `getCat` function:

<Code
  code={`
    const [currentCat, setCurrentCat] = useState(null)
`}
/>

We should also tell JavaScript to import `useState` from React and we do that by changing our React import to:

<Code
  code={`
import React, { useState, useEffect } from 'react'
`}
/>

This will tell React that it should start with that part of the state as null and that we will manipulate it later, which we do by assigning it to the image URL (`data.cat`) we get from the API with `setCurrentCat`: 

<Code
  code={`
    fetch(url)
      .then(response => response.json())
      .then(data => setCurrentCat(data.cat))
`}
/>

## Call the `getCat` on page load

So far we have a `getCat` function, but it's not being called anywhere. This means we don't have a cat image URL yet.

This is where the `useEffect` hook comes in and it will let us fetch data for our app. It tells React that our component needs to do something after it has been rendered. The function we pass (`getCat()`) will be remembered and React will call it after performing the DOM update. [Effects](https://reactjs.org/docs/hooks-effect.html) run in several parts of the react component lifecycle.

The syntax is like this:

<Code
  code={`
  useEffect(() => {
    // function to run
  }, [/* Dependencies */])
`}
/>

Dependencies mean values that need to change in order for the effect to run again. In our case, we want the effect to run when the page loads and set an empty array:

<Code
  code={`
  useEffect(() => {
    getCat()
  }, [])
`}
/>

> Leaving out the second parameter out of the function would tell react to run this function everytime there was a change in our component

## Updating the render

Now that we have the photo in our state we can render that instead of our static image.

Right now we have this:

<Code
  language="markup"
  code={`
<img
  className="cat-image"
  src="https://catis.life/placeholder/400"
  alt="An awesome cat"
/>
  `}
/>

But we want to substitute the src with a variable from the state so we need to interpolate it. In React we do this by wrapping the property value in `{}`.

<Code
  language="markup"
  code={`
<img
  className="cat-image"
  src={currentCat}
  alt="An awesome cat"
/>
  `}
/>

You should now have a new cat being loaded every time you load the page ðŸŽ‰
